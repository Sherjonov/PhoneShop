<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhoneShop - Eng arzon telefonlar O'zbekistonda</title>
    
    <!-- Favicon -->
    <link rel="icon" href="assets/favicon.ico" type="image/x-icon">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="iPhone, Samsung, Xiaomi telefonlari va aksessuarlari eng arzon narxlarda. Bepul yetkazib berish va rasmiy kafolat.">
    <meta name="keywords" content="telefon, smartphone, iPhone, Samsung, Xiaomi, aksessuar, O'zbekiston, do'kon">
    <meta name="author" content="PhoneShop">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" as="style">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <!-- Critical CSS inline -->
    <style>
        :root {
            --primary-blue: #2563eb;
            --primary-purple: #7c3aed;
            --primary-cyan: #06b6d4;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f9fafb;
            color: #1f2937;
            overflow-x: hidden;
        }

        /* Optimized animations */
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Product image loading */
        .product-img {
            background: linear-gradient(110deg, #ececec 8%, #f5f5f5 18%, #ececec 33%);
            background-size: 200% 100%;
            animation: 1.5s shine linear infinite;
        }

        @keyframes shine {
            to { background-position-x: -200%; }
        }

        /* Cart animation */
        @keyframes cartBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .cart-bounce {
            animation: cartBounce 0.5s ease;
        }

        /* Mobile first */
        @media (min-width: 640px) {
            .product-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .product-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* Performance optimizations */
        .will-change-transform {
            will-change: transform;
        }

        .backface-hidden {
            backface-visibility: hidden;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="sticky top-0 z-50 bg-white shadow-sm border-b border-gray-100">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between gap-4">
                <!-- Logo -->
                <a href="/" class="flex items-center gap-3 no-underline">
                    <div class="w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-black bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600">
                            PhoneShop
                        </h1>
                        <p class="text-xs text-gray-500">Smartfonlar va aksessuarlar</p>
                    </div>
                </a>

                <!-- Desktop Nav -->
                <nav class="hidden lg:flex items-center gap-8">
                    <a href="#home" class="text-gray-700 font-medium hover:text-blue-600 transition-colors duration-200">Bosh sahifa</a>
                    <a href="#products" class="text-gray-700 font-medium hover:text-blue-600 transition-colors duration-200">Telefonlar</a>
                    <a href="#accessories" class="text-gray-700 font-medium hover:text-blue-600 transition-colors duration-200">Aksessuarlar</a>
                    <a href="#new" class="text-gray-700 font-medium hover:text-blue-600 transition-colors duration-200">Yangi</a>
                    <a href="#contact" class="text-gray-700 font-medium hover:text-blue-600 transition-colors duration-200">Aloqa</a>
                </nav>

                <!-- Cart & Actions -->
                <div class="flex items-center gap-3">
                    <!-- Quick Actions -->
                    <div class="hidden md:flex items-center gap-2">
                        <button onclick="cart.openCart()" class="relative p-2 hover:bg-gray-100 rounded-lg transition-colors">
                            <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                            </svg>
                            <span id="cartCount" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold">0</span>
                        </button>
                        <button onclick="window.location.href='#contact'" class="hidden md:block px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors duration-200">
                            Buyurtma
                        </button>
                    </div>
                    
                    <!-- Mobile Menu -->
                    <button id="mobileMenuBtn" class="lg:hidden p-2 rounded-lg hover:bg-gray-100">
                        <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Mobile Navigation -->
            <div id="mobileNav" class="lg:hidden mt-4 hidden border-t border-gray-100 pt-4">
                <div class="flex flex-col gap-3">
                    <a href="#home" class="text-gray-700 font-medium hover:text-blue-600 py-2">Bosh sahifa</a>
                    <a href="#products" class="text-gray-700 font-medium hover:text-blue-600 py-2">Telefonlar</a>
                    <a href="#accessories" class="text-gray-700 font-medium hover:text-blue-600 py-2">Aksessuarlar</a>
                    <a href="#new" class="text-gray-700 font-medium hover:text-blue-600 py-2">Yangi kelganlar</a>
                    <a href="#contact" class="text-gray-700 font-medium hover:text-blue-600 py-2">Aloqa</a>
                    <div class="flex items-center gap-3 pt-2">
                        <button onclick="cart.openCart()" class="flex-1 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700">
                            Savat (<span id="mobileCartCount">0</span>)
                        </button>
                        <button onclick="window.location.href='#contact'" class="flex-1 py-2 border border-blue-600 text-blue-600 rounded-lg font-medium hover:bg-blue-50">
                            Buyurtma
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="home" class="relative bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 text-white overflow-hidden">
        <div class="absolute inset-0 bg-black/20"></div>
        <div class="container mx-auto px-4 py-16 md:py-24 relative">
            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <div class="text-center lg:text-left">
                    <h1 class="text-4xl md:text-6xl font-black leading-tight mb-6">
                        Smartfonlar<br>
                        <span class="text-yellow-300">Chegirma</span> bilan!
                    </h1>
                    <p class="text-xl mb-8 opacity-90 max-w-xl mx-auto lg:mx-0">
                        iPhone, Samsung, Xiaomi va boshqa brendlarning yangi modellari rasmiy kafolat bilan
                    </p>
                    <div class="flex flex-wrap gap-4 justify-center lg:justify-start">
                        <a href="#products" class="px-8 py-4 bg-white text-blue-600 font-bold rounded-xl hover:bg-gray-100 transform hover:scale-105 transition-all duration-300 shadow-2xl">
                            Mahsulotlarni ko'rish →
                        </a>
                        <a href="#new" class="px-8 py-4 border-2 border-white text-white font-bold rounded-xl hover:bg-white/10 transition-all duration-300">
                            Yangi kelganlar
                        </a>
                    </div>
                </div>
                
                <!-- Hero Image Slider -->
                <div class="relative h-64 md:h-96 rounded-3xl overflow-hidden shadow-2xl">
                    <div id="heroSlider" class="absolute inset-0">
                        <img src="https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=800&auto=format&fit=crop" 
                             alt="iPhone telefon" 
                             class="w-full h-full object-cover">
                    </div>
                    <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2">
                        <div class="w-3 h-3 bg-white rounded-full"></div>
                        <div class="w-3 h-3 bg-white/50 rounded-full"></div>
                        <div class="w-3 h-3 bg-white/50 rounded-full"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Stats -->
    <div class="bg-white border-b border-gray-100">
        <div class="container mx-auto px-4 py-6">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="text-center p-4">
                    <div class="text-2xl md:text-3xl font-bold text-blue-600 mb-1">50+</div>
                    <div class="text-gray-600 text-sm">Telefon modellari</div>
                </div>
                <div class="text-center p-4">
                    <div class="text-2xl md:text-3xl font-bold text-purple-600 mb-1">100+</div>
                    <div class="text-gray-600 text-sm">Aksessuarlar</div>
                </div>
                <div class="text-center p-4">
                    <div class="text-2xl md:text-3xl font-bold text-green-600 mb-1">24/7</div>
                    <div class="text-gray-600 text-sm">Texnik yordam</div>
                </div>
                <div class="text-center p-4">
                    <div class="text-2xl md:text-3xl font-bold text-cyan-600 mb-1">1 yil</div>
                    <div class="text-gray-600 text-sm">Rasmiy kafolat</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Products Section -->
    <section id="products" class="py-12 md:py-20">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">
                    Eng mashhur<br>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600">smartfonlar</span>
                </h2>
                <p class="text-gray-600 max-w-2xl mx-auto">
                    Barcha zamonaviy smartfonlarni bir joyda toping. Eng so'nggi texnologiyalar va eng yaxshi narxlar.
                </p>
            </div>

            <!-- Quick Filters -->
            <div class="flex flex-wrap gap-2 mb-8 justify-center">
                <button onclick="filterProducts('all')" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium transition-colors duration-200">
                    Barchasi
                </button>
                <button onclick="filterProducts('iphone')" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors duration-200">
                    iPhone
                </button>
                <button onclick="filterProducts('samsung')" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors duration-200">
                    Samsung
                </button>
                <button onclick="filterProducts('xiaomi')" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors duration-200">
                    Xiaomi
                </button>
                <button onclick="filterProducts('cheap')" class="px-4 py-2 bg-green-100 text-green-700 rounded-lg font-medium hover:bg-green-200 transition-colors duration-200">
                    Arzonlar
                </button>
            </div>

            <!-- Products Grid -->
            <div id="productsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Products will load here -->
            </div>

            <!-- Loading State -->
            <div id="loadingProducts" class="text-center py-12">
                <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent"></div>
                <p class="text-gray-600 mt-4">Mahsulotlar yuklanmoqda...</p>
            </div>

            <!-- Load More -->
            <div class="text-center mt-12">
                <button id="loadMore" onclick="loadMoreProducts()" class="px-8 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors duration-200 hidden">
                    Ko'proq mahsulotlar
                </button>
            </div>
        </div>
    </section>

    <!-- Cart Sidebar (Right side) -->
    <div id="cartSidebar" class="fixed inset-y-0 right-0 w-full md:w-96 bg-white shadow-2xl transform translate-x-full transition-transform duration-300 z-50">
        <div class="h-full flex flex-col">
            <!-- Cart Header -->
            <div class="p-6 border-b border-gray-200 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                    <h3 class="text-xl font-bold text-gray-800">Savat</h3>
                    <span id="sidebarCartCount" class="bg-blue-100 text-blue-600 text-sm font-medium px-2 py-1 rounded-full">0</span>
                </div>
                <button onclick="cart.closeCart()" class="text-gray-500 hover:text-gray-700">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <!-- Cart Items -->
            <div id="cartItems" class="flex-1 overflow-y-auto p-6">
                <!-- Empty State -->
                <div id="emptyCart" class="text-center py-12">
                    <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                    <p class="text-gray-500 mb-6">Savat bo'sh</p>
                    <button onclick="cart.closeCart(); window.location.href='#products'" class="px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors duration-200">
                        Mahsulot tanlash
                    </button>
                </div>

                <!-- Cart Items List -->
                <div id="cartItemsList" class="space-y-4 hidden"></div>
            </div>

            <!-- Cart Summary -->
            <div id="cartSummary" class="border-t border-gray-200 p-6 hidden">
                <div class="space-y-3 mb-6">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Mahsulotlar:</span>
                        <span id="cartSubtotal" class="font-bold">0 so'm</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Chegirma:</span>
                        <span id="cartDiscount" class="text-green-600 font-bold">-0 so'm</span>
                    </div>
                    <div class="flex justify-between text-lg font-bold border-t border-gray-200 pt-3">
                        <span>Jami:</span>
                        <span id="cartTotal" class="text-blue-600">0 so'm</span>
                    </div>
                </div>

                <!-- Order Form -->
                <div id="orderForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Telefon raqamingiz</label>
                        <input type="tel" id="orderPhone" placeholder="+998 90 123 45 67" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Manzil</label>
                        <textarea id="orderAddress" rows="2" placeholder="Yetkazib berish manzili" 
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                    
                    <div class="space-y-3">
                        <button onclick="cart.checkout()" class="w-full py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg font-bold hover:opacity-90 transition-all duration-200">
                            Buyurtmani rasmiylashtirish
                        </button>
                        <button onclick="cart.clearCart()" class="w-full py-3 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300 transition-colors duration-200">
                            Savatni tozalash
                        </button>
                    </div>
                </div>
            </div>

            <!-- Checkout Button (when empty cart summary is hidden) -->
            <div id="checkoutButton" class="border-t border-gray-200 p-6 hidden">
                <button onclick="cart.checkout()" class="w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-bold hover:opacity-90 transition-all duration-200">
                    Buyurtma berish
                </button>
            </div>
        </div>
    </div>

    <!-- Floating Cart Button -->
    <button onclick="cart.openCart()" id="floatingCart" class="fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-full shadow-2xl flex items-center justify-center z-40 hover:scale-105 transition-transform duration-200">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
        </svg>
        <span id="floatingCartCount" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center font-bold">0</span>
    </button>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-6 right-6 max-w-sm bg-white rounded-xl shadow-2xl border border-gray-200 transform translate-x-full transition-transform duration-300 z-50">
        <div class="p-4">
            <div class="flex items-start gap-3">
                <div id="toastIcon" class="w-6 h-6 flex-shrink-0">
                    <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                </div>
                <div class="flex-1">
                    <p id="toastTitle" class="font-bold text-gray-800"></p>
                    <p id="toastMessage" class="text-gray-600 text-sm mt-1"></p>
                </div>
                <button onclick="hideToast()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Backdrop -->
    <div id="backdrop" class="fixed inset-0 bg-black/50 z-40 hidden"></div>
    <div id="productsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
    </div>

    <div class="text-center mt-12">
        <button id="loadMore" class="px-8 py-3 border-2 border-blue-600 text-blue-600 font-bold rounded-full hover:bg-blue-50 transition-all duration-300 hidden">
            Ko'proq mahsulotlar
            <i class="fas fa-arrow-down ml-2"></i>
        </button>
    </div>
</div>
</section>

<!-- Accessories Section -->


<!-- Features Section -->
<section class="py-20 bg-white">
<div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="text-center p-8 rounded-2xl bg-gradient-to-b from-blue-50 to-white border border-blue-100">
            <div class="w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-6">
                <i class="fas fa-shield-alt text-blue-600 text-2xl"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">Rasmiy Kafolat</h3>
            <p class="text-gray-600">Barcha mahsulotlar rasmiy kafolat bilan. 1 yilgacha texnik xizmat.</p>
        </div>

        <div class="text-center p-8 rounded-2xl bg-gradient-to-b from-green-50 to-white border border-green-100">
            <div class="w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-6">
                <i class="fas fa-truck text-green-600 text-2xl"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">Tez Yetkazib Berish</h3>
            <p class="text-gray-600">Toshkent bo'yicha 2 soat ichida, viloyatlarga 1-3 kun ichida.</p>
        </div>

        <div class="text-center p-8 rounded-2xl bg-gradient-to-b from-purple-50 to-white border border-purple-100">
            <div class="w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-6">
                <i class="fas fa-headset text-purple-600 text-2xl"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">24/7 Qo'llab-quvvatlash</h3>
            <p class="text-gray-600">Har qanday savol uchun doimiy texnik yordam va maslahat.</p>
        </div>
    </div>
</div>
</section>

<!-- Footer -->
<footer class="bg-gray-800 text-white py-12">
<div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
            <div class="flex items-center space-x-3 mb-6">
                <div class="w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full flex items-center justify-center">
                    <i class="fas fa-mobile-alt text-white"></i>
                </div>
                <h2 class="text-2xl font-bold">PhoneShop</h2>
            </div>
            <p class="text-gray-400">
                O'zbekistondagi eng ishonchli onlayn telefon do'koni. Eng so'nggi texnologiyalar va eng yaxshi narxlar.
            </p>
        </div>

        <div>
            <h3 class="text-xl font-bold mb-6">Tez havolalar</h3>
            <ul class="space-y-3">
                <li><a href="#home" class="text-gray-400 hover:text-white transition-colors">Bosh sahifa</a></li>
                <li><a href="#products" class="text-gray-400 hover:text-white transition-colors">Telefonlar</a></li>
                <li><a href="#accessories" class="text-gray-400 hover:text-white transition-colors">Aksessuarlar</a></li>
                <li><a href="#contact" class="text-gray-400 hover:text-white transition-colors">Aloqa</a></li>
            </ul>
        </div>

        <div>
            <h3 class="text-xl font-bold mb-6">Kategoriyalar</h3>
            <ul class="space-y-3">
                <li><a href="#" class="text-gray-400 hover:text-white transition-colors">iPhone</a></li>
                <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Samsung</a></li>
                <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Xiaomi</a></li>
                <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Naushniklar</a></li>
            </ul>
        </div>

        <div>
            <h3 class="text-xl font-bold mb-6">Yangiliklar</h3>
            <p class="text-gray-400 mb-4">
                Yangi mahsulotlar va chegirmalar haqida birinchi bo'lib bilib oling.
            </p>
            <form id="newsletterForm" class="space-y-3">
                <input type="email" placeholder="Email manzilingiz" 
                       class="w-full p-3 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                <button type="submit" class="w-full py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition-colors">
                    Obuna bo'lish
                </button>
            </form>
        </div>
    </div>

    <div class="border-t border-gray-700 mt-12 pt-8 text-center">
        <p class="text-gray-400">
            © 2025 PhoneShop.uz - Barcha huquqlar himoyalangan.
        </p>
        <p class="text-gray-500 text-sm mt-2">
            Made with <i class="fas fa-heart text-red-500"></i> in Uzbekistan
        </p>
    </div>
</div>
</footer>
    <!-- External Resources (Loaded after content) -->
    <script>
        // Load external resources async
        function loadExternalResources() {
            // Tailwind CSS
            const tailwind = document.createElement('script');
            tailwind.src = 'https://cdn.tailwindcss.com';
            tailwind.async = true;
            document.head.appendChild(tailwind);

            // Font Awesome
            const fa = document.createElement('link');
            fa.rel = 'stylesheet';
            fa.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css';
            fa.crossOrigin = 'anonymous';
            document.head.appendChild(fa);

            // Google Fonts
            const font = document.createElement('link');
            font.rel = 'stylesheet';
            font.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap';
            document.head.appendChild(font);
        }

        // Start loading external resources
        window.addEventListener('DOMContentLoaded', loadExternalResources);
    </script>

    <!-- Main Application JavaScript -->
    <script>
        // PhoneShop - Optimized Version
        const API_URL = 'http://localhost:3000/api';
        let currentProducts = [];
        let currentPage = 1;
        const PRODUCTS_PER_PAGE = 8;

        // Shopping Cart Class
        class ShoppingCart {
            constructor() {
                this.cart = JSON.parse(localStorage.getItem('phoneShop_cart')) || [];
                this.init();
            }

            init() {
                this.updateCartUI();
                this.setupEventListeners();
            }

            setupEventListeners() {
                // Cart toggle
                document.getElementById('mobileMenuBtn')?.addEventListener('click', () => {
                    document.getElementById('mobileNav').classList.toggle('hidden');
                });

                // Backdrop click
                document.getElementById('backdrop')?.addEventListener('click', () => {
                    this.closeCart();
                });
            }

            addToCart(productId, productData = null) {
                // If product data is provided, use it (for offline demo)
                if (productData) {
                    const existingItem = this.cart.find(item => item.id === productId);
                    
                    if (existingItem) {
                        if (existingItem.quantity >= (productData.stock || 10)) {
                            showToast('Diqqat', 'Maksimum miqdorga yetib keldi', 'warning');
                            return;
                        }
                        existingItem.quantity += 1;
                    } else {
                        this.cart.push({
                            id: productId,
                            name: productData.name,
                            price: productData.price,
                            discount: productData.discount || 0,
                            image: productData.image,
                            quantity: 1,
                            stock: productData.stock || 10
                        });
                    }

                    this.saveCart();
                    this.updateCartUI();
                    this.animateCart();
                    showToast('Muvaffaqiyatli', `${productData.name} savatga qo'shildi`);
                    return;
                }

                // Otherwise fetch from API
                fetch(`${API_URL}/products/${productId}`)
                    .then(res => res.json())
                    .then(product => {
                        const existingItem = this.cart.find(item => item.id === productId);
                        
                        if (existingItem) {
                            if (existingItem.quantity >= product.stock) {
                                showToast('Diqqat', 'Maksimum miqdorga yetib keldi', 'warning');
                                return;
                            }
                            existingItem.quantity += 1;
                        } else {
                            this.cart.push({
                                id: product.id,
                                name: product.name,
                                price: product.price,
                                discount: product.discount || 0,
                                image: product.image,
                                quantity: 1,
                                stock: product.stock
                            });
                        }

                        this.saveCart();
                        this.updateCartUI();
                        this.animateCart();
                        showToast('Muvaffaqiyatli', `${product.name} savatga qo'shildi`);
                    })
                    .catch(() => {
                        showToast('Xatolik', 'Mahsulot topilmadi', 'error');
                    });
            }

            removeFromCart(productId) {
                this.cart = this.cart.filter(item => item.id !== productId);
                this.saveCart();
                this.updateCartUI();
                showToast('Muvaffaqiyatli', 'Mahsulot olib tashlandi');
            }

            updateQuantity(productId, newQuantity) {
                if (newQuantity < 1) {
                    this.removeFromCart(productId);
                    return;
                }

                const item = this.cart.find(item => item.id === productId);
                if (item) {
                    item.quantity = newQuantity;
                    this.saveCart();
                    this.updateCartUI();
                }
            }

            clearCart() {
                if (this.cart.length === 0) return;
                
                if (confirm('Savatni tozalashni istaysizmi?')) {
                    this.cart = [];
                    this.saveCart();
                    this.updateCartUI();
                    showToast('Muvaffaqiyatli', 'Savat tozalandi');
                }
            }

            saveCart() {
                localStorage.setItem('phoneShop_cart', JSON.stringify(this.cart));
            }

            updateCartUI() {
                const totalItems = this.cart.reduce((sum, item) => sum + item.quantity, 0);
                const totalPrice = this.calculateTotal();

                // Update counts
                document.querySelectorAll('#cartCount, #mobileCartCount, #floatingCartCount, #sidebarCartCount')
                    .forEach(el => el.textContent = totalItems);

                // Update price display
                if (document.getElementById('cartSubtotal')) {
                    document.getElementById('cartSubtotal').textContent = formatPrice(totalPrice.subtotal) + ' so\'m';
                    document.getElementById('cartDiscount').textContent = '-' + formatPrice(totalPrice.discount) + ' so\'m';
                    document.getElementById('cartTotal').textContent = formatPrice(totalPrice.total) + ' so\'m';
                }

                // Show/hide cart elements
                const hasItems = totalItems > 0;
                document.getElementById('cartSummary').classList.toggle('hidden', !hasItems);
                document.getElementById('checkoutButton').classList.toggle('hidden', !hasItems);
                document.getElementById('emptyCart').classList.toggle('hidden', hasItems);
                document.getElementById('cartItemsList').classList.toggle('hidden', !hasItems);

                // Render cart items
                if (hasItems) {
                    this.renderCartItems();
                }
            }

            calculateTotal() {
                let subtotal = 0;
                let discount = 0;
                let total = 0;

                this.cart.forEach(item => {
                    const itemPrice = item.discount > 0 
                        ? item.price * (1 - item.discount / 100)
                        : item.price;
                    
                    subtotal += item.price * item.quantity;
                    discount += (item.price - itemPrice) * item.quantity;
                    total += itemPrice * item.quantity;
                });

                return { subtotal, discount, total };
            }

            renderCartItems() {
                const container = document.getElementById('cartItemsList');
                if (!container) return;

                let html = '';
                this.cart.forEach(item => {
                    const itemPrice = item.discount > 0 
                        ? item.price * (1 - item.discount / 100)
                        : item.price;
                    const totalPrice = itemPrice * item.quantity;

                    html += `
                        <div class="cart-item bg-gray-50 rounded-xl p-4">
                            <div class="flex items-start gap-4">
                                <img src="${item.image || 'https://via.placeholder.com/64'}" 
                                     alt="${item.name}"
                                     class="w-16 h-16 object-contain rounded-lg">
                                <div class="flex-1">
                                    <h4 class="font-bold text-gray-800 text-sm mb-1">${item.name}</h4>
                                    <p class="text-blue-600 font-bold mb-2">${formatPrice(itemPrice)} so'm</p>
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-2">
                                            <button onclick="cart.updateQuantity(${item.id}, ${item.quantity - 1})" 
                                                    class="w-8 h-8 bg-gray-200 rounded-lg flex items-center justify-center hover:bg-gray-300">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4" />
                                                </svg>
                                            </button>
                                            <span class="font-bold w-8 text-center">${item.quantity}</span>
                                            <button onclick="cart.updateQuantity(${item.id}, ${item.quantity + 1})" 
                                                    class="w-8 h-8 bg-gray-200 rounded-lg flex items-center justify-center hover:bg-gray-300">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                                </svg>
                                            </button>
                                        </div>
                                        <button onclick="cart.removeFromCart(${item.id})" 
                                                class="text-red-500 hover:text-red-700">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            }

            animateCart() {
                const floatingCart = document.getElementById('floatingCart');
                if (floatingCart) {
                    floatingCart.classList.add('cart-bounce');
                    setTimeout(() => floatingCart.classList.remove('cart-bounce'), 500);
                }
            }

            openCart() {
                document.getElementById('cartSidebar').classList.remove('translate-x-full');
                document.getElementById('backdrop').classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                this.updateCartUI();
            }

            closeCart() {
                document.getElementById('cartSidebar').classList.add('translate-x-full');
                document.getElementById('backdrop').classList.add('hidden');
                document.getElementById('mobileNav').classList.add('hidden');
                document.body.style.overflow = '';
            }

            async checkout() {
                const phone = document.getElementById('orderPhone')?.value.trim();
                const address = document.getElementById('orderAddress')?.value.trim();

                if (!phone || !address) {
                    showToast('Diqqat', 'Iltimos, telefon raqam va manzilni kiriting', 'warning');
                    return;
                }

                if (this.cart.length === 0) {
                    showToast('Xatolik', 'Savat bo\'sh', 'error');
                    return;
                }

                try {
                    showLoading(true);
                    
                    const orderData = {
                        phone: phone,
                        address: address,
                        items: this.cart.map(item => ({
                            productId: item.id,
                            name: item.name,
                            quantity: item.quantity,
                            price: item.price,
                            discount: item.discount
                        })),
                        total: this.calculateTotal().total,
                        date: new Date().toISOString()
                    };

                    // Save order to localStorage for demo
                    const orders = JSON.parse(localStorage.getItem('phoneShop_orders')) || [];
                    orders.push({
                        ...orderData,
                        id: Date.now(),
                        status: 'pending',
                        orderNumber: 'PS-' + Date.now().toString().slice(-6)
                    });
                    localStorage.setItem('phoneShop_orders', JSON.stringify(orders));

                    // Clear cart
                    this.clearCart();
                    
                    // Close cart
                    this.closeCart();

                    // Show success message
                    showToast('Tabriklaymiz!', 'Buyurtmangiz qabul qilindi. Tez orada operator siz bilan bog\'lanadi', 'success');
                    
                    // Reset form
                    if (document.getElementById('orderPhone')) {
                        document.getElementById('orderPhone').value = '';
                    }
                    if (document.getElementById('orderAddress')) {
                        document.getElementById('orderAddress').value = '';
                    }

                } catch (error) {
                    console.error('Checkout error:', error);
                    showToast('Xatolik', 'Buyurtma berishda xatolik', 'error');
                } finally {
                    showLoading(false);
                }
            }
        }

        // Initialize cart globally
        let cart = new ShoppingCart();

        // Utility functions
        function formatPrice(price) {
            return new Intl.NumberFormat('uz-UZ').format(Math.round(price));
        }

        function showToast(title, message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            const toastIcon = document.getElementById('toastIcon');

            // Set icon based on type
            let icon = `<svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>`;

            if (type === 'error') {
                icon = `<svg class="w-6 h-6 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>`;
            } else if (type === 'warning') {
                icon = `<svg class="w-6 h-6 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.998-.833-2.732 0L4.346 16.5c-.77.833.192 2.5 1.732 2.5z" />
                </svg>`;
            }

            toastIcon.innerHTML = icon;
            toastTitle.textContent = title;
            toastMessage.textContent = message;

            // Show toast
            toast.classList.remove('translate-x-full');

            // Auto hide
            setTimeout(hideToast, 5000);
        }

        function hideToast() {
            document.getElementById('toast').classList.add('translate-x-full');
        }

        function showLoading(show) {
            const body = document.body;
            if (show) {
                body.classList.add('overflow-hidden');
                // You can add a loading spinner here
            } else {
                body.classList.remove('overflow-hidden');
            }
        }

        // Demo products data (fallback if API is not available)
        const DEMO_PRODUCTS = {
            phones: [
                {
                    id: 1,
                    name: "iPhone 17 Pro Max",
                    description: "A19 Pro • 48MP Fusion • Titanium",
                    price: 18990000,
                    category: "phone",
                    image: "https://images.unsplash.com/photo-1605236453806-6ff36851218e?w=800&auto=format&fit=crop",
                    stock: 15,
                    discount: 0,
                    isNew: true,
                    specifications: {
                        display: "6.9'' Super Retina XDR",
                        processor: "A19 Pro",
                        memory: "1TB",
                        battery: "5000mAh"
                    },
                    features: ["Face ID", "ProMotion", "Ceramic Shield", "MagSafe"],
                    createdAt: "2025-01-15T10:30:00Z"
                },
                {
                    id: 2,
                    name: "Samsung Galaxy S25 Ultra",
                    description: "200MP • S Pen • AI",
                    price: 17900000,
                    category: "phone",
                    image: "https://images.unsplash.com/photo-1610945265064-0e34e5519bbf?w-800&auto=format&fit=crop",
                    stock: 12,
                    discount: 10,
                    isNew: true,
                    specifications: {
                        display: "6.8'' Dynamic AMOLED 2X",
                        processor: "Snapdragon 8 Gen 4",
                        memory: "512GB",
                        battery: "5500mAh"
                    },
                    features: ["S Pen", "200MP Camera", "AI Features", "45W Fast Charge"],
                    createdAt: "2025-01-10T14:20:00Z"
                },
                {
                    id: 3,
                    name: "Xiaomi 15 Ultra",
                    description: "Leica • Snapdragon 8 Gen 4",
                    price: 14900000,
                    category: "phone",
                    image: "https://images.unsplash.com/photo-1598327105666-5b89351aff97?w=800&auto=format&fit=crop",
                    stock: 20,
                    discount: 15,
                    isNew: true,
                    specifications: {
                        display: "6.7'' AMOLED",
                        processor: "Snapdragon 8 Gen 4",
                        memory: "512GB",
                        battery: "5300mAh"
                    },
                    features: ["Leica Camera", "120W Charging", "IP68", "120Hz Display"],
                    createdAt: "2025-01-05T09:15:00Z"
                },
                {
                    id: 4,
                    name: "Google Pixel 9 Pro",
                    description: "Tensor G4 • Best Camera",
                    price: 13900000,
                    category: "phone",
                    image: "https://images.unsplash.com/photo-1592899677977-9c10ca588bbd?w=800&auto=format&fit=crop",
                    stock: 8,
                    discount: 5,
                    isNew: false,
                    specifications: {
                        display: "6.7'' LTPO OLED",
                        processor: "Tensor G4",
                        memory: "256GB",
                        battery: "5050mAh"
                    },
                    features: ["Best Camera", "Google AI", "Pure Android", "7 Years Update"],
                    createdAt: "2024-12-20T11:45:00Z"
                },
                {
                    id: 5,
                    name: "OnePlus 13",
                    description: "OxygenOS • Fast Charging",
                    price: 11900000,
                    category: "phone",
                    image: "https://images.unsplash.com/photo-1598327105854-c8674faddf74?w=800&auto=format&fit=crop",
                    stock: 18,
                    discount: 20,
                    isNew: true,
                    specifications: {
                        display: "6.8'' Fluid AMOLED",
                        processor: "Snapdragon 8 Gen 4",
                        memory: "256GB",
                        battery: "6000mAh"
                    },
                    features: ["150W Charging", "Alert Slider", "Hasselblad Camera", "OxygenOS"],
                    createdAt: "2025-01-08T16:30:00Z"
                },
                {
                    id: 6,
                    name: "Samsung Galaxy Z Fold6",
                    description: "Foldable • Multi-Task",
                    price: 22900000,
                    category: "phone",
                    image: "https://images.unsplash.com/photo-1620288627223-53302f4e8c74?w=800&auto=format&fit=crop",
                    stock: 6,
                    discount: 8,
                    isNew: true,
                    specifications: {
                        display: "7.6'' Foldable Dynamic AMOLED",
                        processor: "Snapdragon 8 Gen 4",
                        memory: "1TB",
                        battery: "4800mAh"
                    },
                    features: ["Foldable", "S Pen Support", "Under Display Camera", "Multi Window"],
                    createdAt: "2025-01-12T13:20:00Z"
                },
                {
                    id: 7,
                    name: "iPhone 16 Pro",
                    description: "A18 Pro • Action Button",
                    price: 15900000,
                    category: "phone",
                    image: "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=800&auto=format&fit=crop",
                    stock: 25,
                    discount: 12,
                    isNew: false,
                    specifications: {
                        display: "6.3'' Super Retina XDR",
                        processor: "A18 Pro",
                        memory: "512GB",
                        battery: "4700mAh"
                    },
                    features: ["Action Button", "USB-C", "Titanium Design", "Improved Cameras"],
                    createdAt: "2024-11-30T10:00:00Z"
                },
                {
                    id: 8,
                    name: "Xiaomi 14 Pro",
                    description: "HyperOS • Powerful Performance",
                    price: 12900000,
                    category: "phone",
                    image: "https://images.unsplash.com/photo-1592899677977-9c10ca588bbd?w=800&auto=format&fit=crop",
                    stock: 22,
                    discount: 18,
                    isNew: false,
                    specifications: {
                        display: "6.73'' LTPO AMOLED",
                        processor: "Snapdragon 8 Gen 3",
                        memory: "512GB",
                        battery: "4880mAh"
                    },
                    features: ["HyperOS", "120W Charging", "Leica Summilux Lens", "IP68"],
                    createdAt: "2024-12-15T14:45:00Z"
                }
            ],
            accessories: [
                {
                    id: 101,
                    name: "Apple AirPods Pro 2",
                    description: "ANC • Spatial Audio • USB-C",
                    price: 3290000,
                    category: "accessory",
                    image: "https://images.unsplash.com/photo-1599660640476-9c9f2feb8a94?w=800&auto=format&fit=crop",
                    stock: 25,
                    discount: 20,
                    isNew: false,
                    specifications: {
                        type: "Tishsiz naushnik",
                        battery: "6 soat",
                        connectivity: "Bluetooth 5.3"
                    },
                    features: ["Active Noise Cancellation", "Spatial Audio", "Wireless Charging", "USB-C"],
                    createdAt: "2024-12-20T11:45:00Z"
                },
                {
                    id: 102,
                    name: "Samsung Galaxy Watch7",
                    description: "BioActive Sensor • Long Battery",
                    price: 4290000,
                    category: "accessory",
                    image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=800&auto=format&fit=crop",
                    stock: 18,
                    discount: 15,
                    isNew: true,
                    specifications: {
                        display: "1.5'' Super AMOLED",
                        battery: "40 soat",
                        connectivity: "Bluetooth 5.2, Wi-Fi"
                    },
                    features: ["BioActive Sensor", "ECG", "Sleep Tracking", "Fast Charging"],
                    createdAt: "2025-01-10T09:20:00Z"
                },
                {
                    id: 103,
                    name: "Xiaomi Smart Band 9 Pro",
                    description: "AMOLED • 14-Day Battery",
                    price: 1290000,
                    category: "accessory",
                    image: "https://images.unsplash.com/photo-1508685096489-7aacd43bd3b1?w=800&auto=format&fit=crop",
                    stock: 35,
                    discount: 25,
                    isNew: true,
                    specifications: {
                        display: "1.74'' AMOLED",
                        battery: "14 kun",
                        sensors: "Heart Rate, SpO2, Stress"
                    },
                    features: ["Always-on Display", "150+ Sports Modes", "5ATM Waterproof", "NFC"],
                    createdAt: "2025-01-05T14:30:00Z"
                },
                {
                    id: 104,
                    name: "MagSafe Charger",
                    description: "15W • Magnetic Alignment",
                    price: 790000,
                    category: "accessory",
                    image: "https://images.unsplash.com/photo-1581094794329-c8112a89af12?w=800&auto=format&fit=crop",
                    stock: 50,
                    discount: 10,
                    isNew: false,
                    specifications: {
                        output: "15W",
                        compatibility: "iPhone 12+",
                        cable: "USB-C to USB-C"
                    },
                    features: ["Magnetic Alignment", "Fast Charging", "Compact Design", "LED Indicator"],
                    createdAt: "2024-12-10T16:15:00Z"
                },
                {
                    id: 105,
                    name: "Samsung 45W Charger",
                    description: "Super Fast Charging 2.0",
                    price: 590000,
                    category: "accessory",
                    image: "https://images.unsplash.com/photo-1600231529642-26f7968f0c19?w=800&auto=format&fit=crop",
                    stock: 40,
                    discount: 30,
                    isNew: true,
                    specifications: {
                        output: "45W",
                        ports: "1x USB-C",
                        cable: "Included"
                    },
                    features: ["Super Fast Charging", "PPS Support", "Compact Size", "Overheat Protection"],
                    createdAt: "2025-01-15T11:00:00Z"
                },
                {
                    id: 106,
                    name: "Leather Phone Case",
                    description: "Premium Leather • MagSafe",
                    price: 390000,
                    category: "accessory",
                    image: "https://images.unsplash.com/photo-1546868871-7041f2a55e12?w=800&auto=format&fit=crop",
                    stock: 60,
                    discount: 20,
                    isNew: false,
                    specifications: {
                        material: "Genuine Leather",
                        compatibility: "iPhone 15 Pro",
                        colors: "Black, Brown, Blue"
                    },
                    features: ["MagSafe Compatible", "Premium Feel", "Protective", "Slim Design"],
                    createdAt: "2024-12-05T13:45:00Z"
                },
                {
                    id: 107,
                    name: "Wireless Power Bank",
                    description: "10000mAh • 15W Wireless",
                    price: 890000,
                    category: "accessory",
                    image: "https://images.unsplash.com/photo-1581291518857-4e27b48ff24e?w=800&auto=format&fit=crop",
                    stock: 28,
                    discount: 15,
                    isNew: true,
                    specifications: {
                        capacity: "10000mAh",
                        wireless: "15W",
                        wired: "18W",
                        ports: "2x USB-C, 1x USB-A"
                    },
                    features: ["Wireless Charging", "Fast Charging", "LED Display", "Multiple Ports"],
                    createdAt: "2025-01-03T10:30:00Z"
                },
                {
                    id: 108,
                    name: "Car Phone Holder",
                    description: "Magnetic • 360° Rotation",
                    price: 290000,
                    category: "accessory",
                    image: "https://images.unsplash.com/photo-1590247119936-6604931b241b?w=800&auto=format&fit=crop",
                    stock: 75,
                    discount: 40,
                    isNew: false,
                    specifications: {
                        mount: "Air Vent/CD Slot",
                        magnet: "N52 Strong Magnet",
                        rotation: "360° Ball Joint"
                    },
                    features: ["Strong Magnet", "Easy Installation", "Universal Fit", "Compact Design"],
                    createdAt: "2024-11-25T15:20:00Z"
                }
            ]
        };

        // Product functions
        function createProductCard(product) {
            const discountPrice = product.discount > 0 
                ? product.price * (1 - product.discount / 100) 
                : product.price;
            
            const stockStatus = product.stock > 10 ? 'stock-high' :
                              product.stock > 0 ? 'stock-medium' : 'stock-low';
            const stockText = product.stock > 10 ? 'Zapchastda' :
                            product.stock > 0 ? 'Och ketmoqda' : 'Zapchast qolmagan';

            const div = document.createElement('div');
            div.className = 'product-card bg-white rounded-2xl overflow-hidden border border-gray-200 hover:shadow-xl transition-all duration-300 fade-in';
            div.innerHTML = `
                <div class="relative">
                    <img src="${product.image}" 
                         alt="${product.name}"
                         class="w-full h-48 object-cover"
                         loading="lazy"
                         onerror="this.src='https://via.placeholder.com/400x300/cccccc/ffffff?text=PhoneShop'">
                    
                    ${product.discount > 0 ? `
                        <div class="absolute top-3 left-3 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded">
                            -${product.discount}%
                        </div>
                    ` : ''}
                    
                    ${product.isNew ? `
                        <div class="absolute top-3 right-3 bg-blue-500 text-white text-xs font-bold px-2 py-1 rounded">
                            YANGI
                        </div>
                    ` : ''}
                    
                    <div class="absolute bottom-3 right-3 ${stockStatus} text-xs font-bold px-2 py-1 rounded bg-white/90">
                        ${stockText}
                    </div>
                </div>
                
                <div class="p-4">
                    <h3 class="font-bold text-gray-800 text-sm mb-2 line-clamp-2" style="height: 2.5rem;">${product.name}</h3>
                    <p class="text-gray-600 text-xs mb-3 line-clamp-2" style="height: 2rem;">${product.description}</p>
                    
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            ${product.discount > 0 ? `
                                <div class="flex items-center gap-2">
                                    <span class="text-lg font-bold text-blue-600">${formatPrice(discountPrice)} so'm</span>
                                    <span class="text-sm text-gray-400 line-through">${formatPrice(product.price)} so'm</span>
                                </div>
                            ` : `
                                <span class="text-lg font-bold text-blue-600">${formatPrice(product.price)} so'm</span>
                            `}
                        </div>
                        <span class="text-xs text-gray-500">${product.stock} dona</span>
                    </div>
                    
                    <div class="flex gap-2">
                        <button onclick="cart.addToCart(${product.id}, ${JSON.stringify(product).replace(/"/g, '&quot;')})" 
                                class="flex-1 bg-blue-600 text-white text-sm font-medium py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200">
                            Savatga
                        </button>
                        <button onclick="quickView(${product.id})" 
                                class="px-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                            </svg>
                        </button>
                    </div>
                </div>
            `;
            return div;
        }

        async function loadProducts() {
            const container = document.getElementById('productsGrid');
            const loadingElement = document.getElementById('loadingProducts');
            
            try {
                // Try to fetch from API
                const response = await fetch(`${API_URL}/products`);
                if (response.ok) {
                    const data = await response.json();
                    currentProducts = [...data.phones, ...data.accessories];
                } else {
                    // Fallback to demo data
                    throw new Error('API not available');
                }
            } catch (error) {
                // Use demo data
                console.log('Using demo products data');
                currentProducts = [...DEMO_PRODUCTS.phones, ...DEMO_PRODUCTS.accessories];
            }

            // Hide loading
            if (loadingElement) {
                loadingElement.remove();
            }

            // Render first page
            renderProducts(currentProducts.slice(0, PRODUCTS_PER_PAGE));

            // Show load more button if needed
            if (currentProducts.length > PRODUCTS_PER_PAGE) {
                document.getElementById('loadMore').classList.remove('hidden');
            }
        }

        function renderProducts(products, append = false) {
            const container = document.getElementById('productsGrid');
            
            if (!append) {
                container.innerHTML = '';
            }

            if (products.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <h3 class="text-lg font-bold text-gray-800 mb-2">Mahsulot topilmadi</h3>
                        <p class="text-gray-600">Boshqa filterlar bilan urinib ko'ring</p>
                    </div>
                `;
                return;
            }

            products.forEach(product => {
                const productElement = createProductCard(product);
                container.appendChild(productElement);
            });
        }

        function filterProducts(category) {
            let filtered = [];
            
            switch(category) {
                case 'all':
                    filtered = currentProducts;
                    break;
                case 'iphone':
                    filtered = currentProducts.filter(p => 
                        p.name.toLowerCase().includes('iphone') || 
                        p.description.toLowerCase().includes('iphone'));
                    break;
                case 'samsung':
                    filtered = currentProducts.filter(p => 
                        p.name.toLowerCase().includes('samsung') || 
                        p.description.toLowerCase().includes('samsung'));
                    break;
                case 'xiaomi':
                    filtered = currentProducts.filter(p => 
                        p.name.toLowerCase().includes('xiaomi') || 
                        p.description.toLowerCase().includes('xiaomi'));
                    break;
                case 'cheap':
                    filtered = currentProducts.filter(p => p.price < 10000000);
                    break;
                case 'discounted':
                    filtered = currentProducts.filter(p => p.discount > 0);
                    break;
                default:
                    filtered = currentProducts;
            }

            // Update UI
            const container = document.getElementById('productsGrid');
            container.innerHTML = '';
            
            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <h3 class="text-lg font-bold text-gray-800 mb-2">Mahsulot topilmadi</h3>
                        <p class="text-gray-600">Boshqa filterlar bilan urinib ko'ring</p>
                    </div>
                `;
                document.getElementById('loadMore').classList.add('hidden');
                return;
            }

            renderProducts(filtered.slice(0, PRODUCTS_PER_PAGE));
            
            // Show/hide load more
            if (filtered.length > PRODUCTS_PER_PAGE) {
                document.getElementById('loadMore').classList.remove('hidden');
                currentPage = 1;
            } else {
                document.getElementById('loadMore').classList.add('hidden');
            }
        }

        function loadMoreProducts() {
            currentPage++;
            const start = (currentPage - 1) * PRODUCTS_PER_PAGE;
            const end = start + PRODUCTS_PER_PAGE;
            
            const moreProducts = currentProducts.slice(start, end);
            renderProducts(moreProducts, true);
            
            // Hide button if no more products
            if (end >= currentProducts.length) {
                document.getElementById('loadMore').classList.add('hidden');
            }
        }

        function quickView(productId) {
            // Find product
            const product = currentProducts.find(p => p.id === productId);
            if (!product) return;

            // Create modal
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-6">
                            <h3 class="text-2xl font-bold text-gray-800">${product.name}</h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-8">
                            <div>
                                <img src="${product.image}" 
                                     alt="${product.name}"
                                     class="w-full h-96 object-contain rounded-xl">
                            </div>
                            
                            <div>
                                <p class="text-gray-600 mb-6">${product.description}</p>
                                
                                <div class="mb-6">
                                    ${product.discount > 0 ? `
                                        <div class="flex items-center gap-4 mb-2">
                                            <span class="text-3xl font-bold text-blue-600">
                                                ${formatPrice(product.price * (1 - product.discount / 100))} so'm
                                            </span>
                                            <span class="text-xl text-gray-400 line-through">
                                                ${formatPrice(product.price)} so'm
                                            </span>
                                            <span class="bg-red-500 text-white px-3 py-1 rounded font-bold">
                                                -${product.discount}%
                                            </span>
                                        </div>
                                    ` : `
                                        <span class="text-3xl font-bold text-blue-600">
                                            ${formatPrice(product.price)} so'm
                                        </span>
                                    `}
                                </div>
                                
                                ${product.features && product.features.length > 0 ? `
                                    <div class="mb-6">
                                        <h4 class="font-bold text-gray-800 mb-3">Imkoniyatlar:</h4>
                                        <div class="flex flex-wrap gap-2">
                                            ${product.features.map(feature => `
                                                <span class="bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full">
                                                    ${feature}
                                                </span>
                                            `).join('')}
                                        </div>
                                    </div>
                                ` : ''}
                                
                                <div class="mb-6">
                                    <p class="text-gray-700">
                                        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                                        </svg>
                                        Zapchastlar: 
                                        <span class="font-bold ${product.stock > 10 ? 'text-green-600' : product.stock > 0 ? 'text-yellow-600' : 'text-red-600'}">
                                            ${product.stock} dona
                                        </span>
                                    </p>
                                </div>
                                
                                <div class="flex gap-4">
                                    <button onclick="cart.addToCart(${product.id}, ${JSON.stringify(product).replace(/"/g, '&quot;')}); this.closest('.fixed').remove()" 
                                            class="flex-1 bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition-colors duration-200">
                                        Savatga qo'shish
                                    </button>
                                    <button onclick="cart.addToCart(${product.id}, ${JSON.stringify(product).replace(/"/g, '&quot;')}); cart.openCart(); this.closest('.fixed').remove()" 
                                            class="flex-1 bg-gradient-to-r from-green-600 to-emerald-600 text-white font-bold py-3 rounded-lg hover:opacity-90 transition-all duration-200">
                                        Hoziroq sotib olish
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', () => {
            // Load products
            loadProducts();
            
            // Add smooth scrolling for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                        
                        // Close mobile menu if open
                        document.getElementById('mobileNav').classList.add('hidden');
                    }
                });
            });

            // Add scroll to top button
            const scrollBtn = document.createElement('button');
            scrollBtn.innerHTML = `
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18" />
                </svg>
            `;
            scrollBtn.className = 'fixed bottom-6 left-6 w-12 h-12 bg-gray-800 text-white rounded-full shadow-lg hover:bg-gray-900 transition-colors duration-200 hidden z-40';
            scrollBtn.id = 'scrollTopBtn';
            scrollBtn.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
            document.body.appendChild(scrollBtn);

            // Show/hide scroll button
            window.addEventListener('scroll', () => {
                const btn = document.getElementById('scrollTopBtn');
                if (window.scrollY > 300) {
                    btn.classList.remove('hidden');
                } else {
                    btn.classList.add('hidden');
                }
            });

            // Show welcome message after a delay
            setTimeout(() => {
                showToast('Xush kelibsiz!', 'PhoneShop do\'koniga xush kelibsiz!');
            }, 1500);
        });

        // Global functions for HTML onclick
        function addToCart(productId) {
            cart.addToCart(productId);
        }

        function openCart() {
            cart.openCart();
        }
    </script>
    <!-- Register Button qo'shamiz (Login modal ichida) -->
<script>
    // Login modal HTML qo'shamiz (agar mavjud bo'lmasa)
    function addLoginModal() {
        if (!document.getElementById('loginModal')) {
            const modalHTML = `
                <!-- Login/Register Modal -->
                <div id="loginModal" class="fixed inset-0 bg-black/50 z-50 hidden items-center justify-center p-4">
                    <div class="bg-white rounded-2xl w-full max-w-md">
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-2xl font-bold" id="modalTitle">Kirish</h3>
                                <button onclick="closeLoginModal()" class="text-gray-500 hover:text-gray-700">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>

                            <!-- Login Form (default) -->
                            <form id="loginForm" class="space-y-4">
                                <div>
                                    <label class="block text-gray-700 mb-2">Telefon raqam</label>
                                    <input type="tel" id="loginPhone" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                           placeholder="+998 90 123 45 67" required>
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">Parol</label>
                                    <input type="password" id="loginPassword" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                           placeholder="Parolingizni kiriting" required>
                                </div>

                                <button type="submit" class="w-full py-3 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition-colors">
                                    Kirish
                                </button>
                            </form>

                            <!-- Register Form (hidden by default) -->
                            <form id="registerForm" class="space-y-4 hidden">
                                <div>
                                    <label class="block text-gray-700 mb-2">Ism</label>
                                    <input type="text" id="registerName" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                           placeholder="Ismingiz" required>
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">Telefon raqam</label>
                                    <input type="tel" id="registerPhone" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                           placeholder="+998 90 123 45 67" required>
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">Email</label>
                                    <input type="email" id="registerEmail" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                           placeholder="email@example.com">
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">Parol</label>
                                    <input type="password" id="registerPassword" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                           placeholder="Kamida 6 ta belgi" required minlength="6">
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">Parolni tasdiqlang</label>
                                    <input type="password" id="registerConfirmPassword" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                           placeholder="Parolni qayta kiriting" required>
                                </div>

                                <div class="flex items-center">
                                    <input type="checkbox" id="registerAgree" 
                                           class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500" required>
                                    <label for="registerAgree" class="ml-2 text-sm text-gray-600">
                                        <a href="#" class="text-blue-600 hover:underline">Foydalanish shartlari</a> bilan roziman
                                    </label>
                                </div>
                            </form>

                            <!-- Switch between Login/Register -->
                            <div class="mt-6 text-center">
                                <p id="switchText" class="text-gray-600">
                                    Akkauntingiz yo'qmi?
                                    <button onclick="showRegisterForm()" class="text-blue-600 font-bold hover:underline ml-1">
                                        Ro'yxatdan o'ting
                                    </button>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
    }

    // Header ga Login/Register button qo'shamiz
    function addAuthButtons() {
        const headerActions = document.querySelector('header .flex.items-center.gap-3');
        if (headerActions) {
            // User button qo'shamiz
            const userButton = `
                <button onclick="openLoginModal()" class="hidden md:flex items-center gap-2 p-2 rounded-lg hover:bg-gray-100 transition-colors">
                    <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                    </div>
                    <span class="text-gray-700 font-medium">Kirish</span>
                </button>
            `;
            
            headerActions.insertAdjacentHTML('beforeend', userButton);
        }
    }

    // Modal functions
    function openLoginModal() {
        document.getElementById('loginModal').classList.remove('hidden');
        document.body.style.overflow = 'hidden';
        document.getElementById('backdrop').classList.remove('hidden');
    }

    function closeLoginModal() {
        document.getElementById('loginModal').classList.add('hidden');
        document.body.style.overflow = '';
        document.getElementById('backdrop').classList.add('hidden');
        showLoginForm(); // Reset to login form
    }

    function showLoginForm() {
        document.getElementById('loginForm').classList.remove('hidden');
        document.getElementById('registerForm').classList.add('hidden');
        document.getElementById('modalTitle').textContent = 'Kirish';
        document.getElementById('switchText').innerHTML = `
            Akkauntingiz yo'qmi?
            <button onclick="showRegisterForm()" class="text-blue-600 font-bold hover:underline ml-1">
                Ro'yxatdan o'ting
            </button>
        `;
    }

    function showRegisterForm() {
        document.getElementById('loginForm').classList.add('hidden');
        document.getElementById('registerForm').classList.remove('hidden');
        document.getElementById('modalTitle').textContent = "Ro'yxatdan o'tish";
        document.getElementById('switchText').innerHTML = `
            Akkauntingiz bormi?
            <button onclick="showLoginForm()" class="text-blue-600 font-bold hover:underline ml-1">
                Kirish
            </button>
        `;
    }

    // Form handlers
    function setupFormHandlers() {
        // Login form
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const phone = document.getElementById('loginPhone').value;
            const password = document.getElementById('loginPassword').value;

            // Simple validation
            if (phone && password) {
                // Demo login - save to localStorage
                const user = {
                    phone: phone,
                    name: phone.replace(/\D/g, '').slice(-4), // Last 4 digits as demo name
                    isLoggedIn: true,
                    loginTime: new Date().toISOString()
                };
                localStorage.setItem('phoneShop_user', JSON.stringify(user));
                
                showToast('Muvaffaqiyatli kirish!', `Xush kelibsiz, ${user.name}!`);
                closeLoginModal();
                
                // Update user button
                updateUserButton(user);
            } else {
                showToast('Diqqat', 'Iltimos, barcha maydonlarni to\'ldiring', 'warning');
            }
        });

        // Register form
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const phone = document.getElementById('registerPhone').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            const agree = document.getElementById('registerAgree').checked;

            // Validation
            if (!name || !phone || !password || !confirmPassword) {
                showToast('Diqqat', 'Iltimos, barcha zarur maydonlarni to\'ldiring', 'warning');
                return;
            }

            if (password !== confirmPassword) {
                showToast('Xatolik', 'Parollar mos kelmadi', 'error');
                return;
            }

            if (password.length < 6) {
                showToast('Diqqat', 'Parol kamida 6 ta belgidan iborat bo\'lishi kerak', 'warning');
                return;
            }

            if (!agree) {
                showToast('Diqqat', 'Foydalanish shartlari bilan rozilik bildirishingiz kerak', 'warning');
                return;
            }

            // Save user to localStorage
            const user = {
                id: Date.now(),
                name: name,
                phone: phone,
                email: email || '',
                registeredAt: new Date().toISOString(),
                isLoggedIn: true,
                orders: []
            };

            localStorage.setItem('phoneShop_user', JSON.stringify(user));
            
            showToast('Tabriklaymiz!', `${name}, ro'yxatdan muvaffaqiyatli o'tdingiz!`, 'success');
            closeLoginModal();
            
            // Update user button
            updateUserButton(user);
        });
    }

    function updateUserButton(user) {
        const userButton = document.querySelector('button[onclick="openLoginModal()"]');
        if (userButton && user) {
            userButton.innerHTML = `
                <div class="w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                </div>
                <span class="text-gray-700 font-medium">${user.name}</span>
            `;
            userButton.setAttribute('onclick', 'showUserMenu()');
        }
    }

    function showUserMenu() {
        const user = JSON.parse(localStorage.getItem('phoneShop_user'));
        if (!user) return;

        // Create user dropdown
        const dropdown = document.createElement('div');
        dropdown.className = 'absolute top-full right-0 mt-2 w-48 bg-white rounded-xl shadow-2xl border border-gray-200 z-50';
        dropdown.innerHTML = `
            <div class="p-4 border-b border-gray-100">
                <div class="font-bold text-gray-800">${user.name}</div>
                <div class="text-sm text-gray-600 mt-1">${user.phone}</div>
                ${user.email ? `<div class="text-xs text-gray-500 mt-1">${user.email}</div>` : ''}
            </div>
            <div class="p-2">
                <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100 text-gray-700">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                    </svg>
                    Mening buyurtmalarim
                </a>
                <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100 text-gray-700">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    Sozlamalar
                </a>
                <button onclick="logout()" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-50 text-red-600 mt-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    Chiqish
                </button>
            </div>
        `;

        // Add dropdown and handle clicks outside
        document.body.appendChild(dropdown);
        
        const closeDropdown = (e) => {
            if (!dropdown.contains(e.target) && !e.target.closest('button[onclick="showUserMenu()"]')) {
                dropdown.remove();
                document.removeEventListener('click', closeDropdown);
            }
        };
        
        setTimeout(() => document.addEventListener('click', closeDropdown), 10);
    }

    function logout() {
        localStorage.removeItem('phoneShop_user');
        showToast('Xayr!', 'Tizimdan muvaffaqiyatli chiqdingiz');
        
        // Reset user button
        const userButton = document.querySelector('button[onclick="showUserMenu()"]');
        if (userButton) {
            userButton.innerHTML = `
                <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                </div>
                <span class="text-gray-700 font-medium">Kirish</span>
            `;
            userButton.setAttribute('onclick', 'openLoginModal()');
        }
        
        // Remove dropdown
        document.querySelectorAll('.absolute.top-full.right-0').forEach(el => el.remove());
    }

    // Initialize when page loads
    window.addEventListener('DOMContentLoaded', () => {
        addLoginModal();
        addAuthButtons();
        setupFormHandlers();
        
        // Check if user is already logged in
        const user = JSON.parse(localStorage.getItem('phoneShop_user'));
        if (user && user.isLoggedIn) {
            updateUserButton(user);
        }
    });

    // Yoki soddaroq versiya - faqat button qo'shish
    function addSimpleRegisterButton() {
        // Header ga qo'shamiz
        const header = document.querySelector('header .container .flex.items-center.justify-between');
        if (header) {
            const registerBtn = `
                <div class="hidden md:flex items-center gap-3">
                    <button onclick="openLoginModal()" class="px-4 py-2 border border-blue-600 text-blue-600 rounded-lg font-medium hover:bg-blue-50 transition-colors">
                        Ro'yhatdan O'tish
                    </button>
                </div>
            `;
            header.innerHTML += registerBtn;
        }
    }

    // Soddalashtirilgan modal
    function openRegisterModal() {
        const modalHTML = `
            <div class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                <div class="bg-white rounded-2xl w-full max-w-md">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold">Ro'yxatdan o'tish</h3>
                            <button onclick="closeRegisterModal()" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                        </div>

                        <form id="quickRegisterForm" class="space-y-4">
                            <div>
                                <label class="block text-gray-700 mb-2">Ism</label>
                                <input type="text" id="quickName" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                       placeholder="Ismingiz" required>
                            </div>

                            <div>
                                <label class="block text-gray-700 mb-2">Telefon raqam</label>
                                <input type="tel" id="quickPhone" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                       placeholder="+998 90 123 45 67" required>
                            </div>

                            <button type="submit" class="w-full py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg font-bold hover:opacity-90 transition-all">
                                Ro'yxatdan o'tish
                            </button>
                        </form>

                        <div class="mt-4 text-center">
                            <p class="text-sm text-gray-600">
                                Ro'yxatdan o'tish orqali siz 
                                <a href="#" class="text-blue-600 hover:underline">Foydalanish shartlari</a> bilan rozilik bildirasiz
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        const modalDiv = document.createElement('div');
        modalDiv.innerHTML = modalHTML;
        modalDiv.id = 'quickRegisterModal';
        document.body.appendChild(modalDiv);
        document.body.style.overflow = 'hidden';

        // Form handler
        document.getElementById('quickRegisterForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('quickName').value;
            const phone = document.getElementById('quickPhone').value;

            if (name && phone) {
                // Save to localStorage
                const user = {
                    id: Date.now(),
                    name: name,
                    phone: phone,
                    registeredAt: new Date().toISOString(),
                    isLoggedIn: true
                };
                localStorage.setItem('phoneShop_user', JSON.stringify(user));
                
                showToast('Tabriklaymiz!', `${name}, ro'yxatdan muvaffaqiyatli o'tdingiz!`, 'success');
                closeRegisterModal();
                
                // Update UI
                updateUserButton(user);
            }
        });
    }

    function closeRegisterModal() {
        const modal = document.getElementById('quickRegisterModal');
        if (modal) {
            modal.remove();
        }
        document.body.style.overflow = '';
    }
</script>

<!-- Soddalashtirilgan versiya uchun init -->
<script>
    // Agar soddalashtirilgan versiyani ishlatmoqchi bo'lsangiz
    window.addEventListener('DOMContentLoaded', () => {
        // Faqat register button qo'shish
        addSimpleRegisterButton();
    });
</script>
</body>
</html>